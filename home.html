<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, min-width=1200px">
  <title>GitHub é¡¹ç›®æºç æ£€ç´¢å·¥å…·</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-html.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            github: {
              primary: '#24292f',
              secondary: '#f6f8fa',
              accent: '#DE0000',
              light: '#e1e4e8',
              dark: '#1f2328'
            }
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
            mono: ['Consolas', 'Monaco', 'monospace']
          }
        }
      }
    }
  </script>
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
      .scrollbar-hide::-webkit-scrollbar {
        display: none;
      }
      .col-1 {
        width: 25%;
      }
      .col-2 {
        width: 25%;
      }
      .col-3 {
        width: 50%;
      }
      .code-height {
        height: calc(100vh - 120px);
      }
      .emoji-icon {
        font-size: 1.2em;
        line-height: 1;
      }
      .loading-emoji {
        animation: spin 1.5s linear infinite;
      }
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
    }
  </style>
</head>
<body class="bg-gray-50 text-github-primary overflow-hidden h-screen">
  <div class="flex h-screen w-full">
    <div class="col-1 bg-white border-r border-github-light flex flex-col">
      <div class="p-4 border-b border-github-light">
        <div class="relative">
          <input type="text" id="searchInput" placeholder="æœç´¢GitHubç”¨æˆ·/ä»“åº“..." class="w-full pl-10 pr-4 py-2 rounded-md border border-github-light bg-github-secondary focus:outline-none focus:ring-2 focus:ring-github-accent/50 focus:border-github-accent">
          <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 emoji-icon">ğŸ”</span>
        </div>
        <div class="flex gap-2 mt-3">
          <button id="searchUser" class="px-3 py-1 rounded-md bg-github-accent text-white text-sm hover:bg-github-accent/90">ç”¨æˆ·</button>
          <button id="searchRepo" class="px-3 py-1 rounded-md bg-gray-200 text-gray-700 text-sm hover:bg-gray-300">ä»“åº“</button>
        </div>
      </div>
      <div id="searchResult" class="flex-1 overflow-y-auto scrollbar-hide p-2">
        <div class="text-center text-gray-400 py-10">
          <span class="block text-5xl mb-3">ğŸ™</span>
          <p>è¾“å…¥å…³é”®è¯æœç´¢GitHubç”¨æˆ·/ä»“åº“</p>
        </div>
      </div>
    </div>
    <div class="col-2 bg-white border-r border-github-light flex flex-col">
      <div class="p-4 border-b border-github-light">
        <h3 id="projectTitle" class="font-semibold text-lg">é¡¹ç›®æ–‡ä»¶åˆ—è¡¨</h3>
      </div>
      <div id="fileList" class="flex-1 overflow-y-auto scrollbar-hide p-2">
        <div class="text-center text-gray-400 py-10">
          <span class="block text-5xl mb-3">ğŸ“‚</span>
          <p>è¯·å…ˆé€‰æ‹©ä¸€ä¸ªGitHubä»“åº“</p>
        </div>
      </div>
    </div>
    <div class="col-3 flex flex-col bg-github-dark text-white">
      <div class="p-4 border-b border-gray-700 flex justify-between items-center">
        <h3 id="codeTitle" class="font-semibold text-lg">æºç æŸ¥çœ‹</h3>
        <button id="downloadCode" class="px-3 py-1 rounded-md bg-github-accent text-white text-sm hover:bg-github-accent/90 flex items-center gap-1">
          <span class="emoji-icon">ğŸ“¥</span>
          <span>ä¸‹è½½æºç </span>
        </button>
      </div>
      <div class="flex-1 overflow-y-auto p-4">
        <div id="codeContainer" class="code-height flex items-center justify-center text-gray-400">
          <div class="text-center">
            <span class="block text-5xl mb-3">ğŸ’»</span>
            <p>é€‰æ‹©æ–‡ä»¶æŸ¥çœ‹æºç </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const searchInput = document.getElementById('searchInput');
    const searchUser = document.getElementById('searchUser');
    const searchRepo = document.getElementById('searchRepo');
    const searchResult = document.getElementById('searchResult');
    const projectTitle = document.getElementById('projectTitle');
    const fileList = document.getElementById('fileList');
    const codeContainer = document.getElementById('codeContainer');
    const downloadCode = document.getElementById('downloadCode');
    let currentSearchType = 'user';
    let currentRepo = null;
    let currentFile = null;
    let currentCode = '';

    searchUser.addEventListener('click', () => {
      currentSearchType = 'user';
      searchUser.classList.remove('bg-gray-200', 'text-gray-700');
      searchUser.classList.add('bg-github-accent', 'text-white');
      searchRepo.classList.remove('bg-github-accent', 'text-white');
      searchRepo.classList.add('bg-gray-200', 'text-gray-700');
      if (searchInput.value) search();
    });

    searchRepo.addEventListener('click', () => {
      currentSearchType = 'repo';
      searchRepo.classList.remove('bg-gray-200', 'text-gray-700');
      searchRepo.classList.add('bg-github-accent', 'text-white');
      searchUser.classList.remove('bg-github-accent', 'text-white');
      searchUser.classList.add('bg-gray-200', 'text-gray-700');
      if (searchInput.value) search();
    });

    searchInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && searchInput.value.trim()) search();
    });

    downloadCode.addEventListener('click', () => {
      if (!currentFile || !currentCode) {
        alert('è¯·å…ˆé€‰æ‹©å¹¶åŠ è½½æºç æ–‡ä»¶');
        return;
      }
      const blob = new Blob([currentCode], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = currentFile.name;
      a.click();
      URL.revokeObjectURL(url);
    });

    async function search() {
      const keyword = searchInput.value.trim();
      if (!keyword) return;
      searchResult.innerHTML = '<div class="text-center text-gray-400 py-8"><span class="loading-emoji text-3xl">ğŸ”„</span></div>';
      try {
        const url = currentSearchType === 'user' 
          ? `https://api.github.com/search/users?q=${keyword}&per_page=20`
          : `https://api.github.com/search/repositories?q=${keyword}&per_page=20`;
        const res = await fetch(url);
        if (!res.ok) throw new Error('è¯·æ±‚å¤±è´¥');
        const data = await res.json();
        renderSearchResult(data.items);
      } catch (err) {
        searchResult.innerHTML = `<div class="text-center text-red-500 py-8"><span class="emoji-icon mr-1">âŒ</span> ${err.message}</div>`;
      }
    }

    function renderSearchResult(items) {
      if (!items.length) {
        searchResult.innerHTML = '<div class="text-center text-gray-400 py-8"><span class="emoji-icon mr-1">ğŸ”</span> æ— æœç´¢ç»“æœ</div>';
        return;
      }
      searchResult.innerHTML = '';
      items.forEach(item => {
        const card = document.createElement('div');
        card.className = 'p-3 rounded-md hover:bg-github-secondary cursor-pointer mb-2 border border-transparent hover:border-github-light';
        if (currentSearchType === 'user') {
          card.innerHTML = `
            <div class="flex items-center gap-3">
              <img src="${item.avatar_url}" alt="${item.login}" class="w-10 h-10 rounded-full">
              <div>
                <p class="font-semibold">${item.login}</p>
                <p class="text-xs text-gray-500">@${item.login}</p>
              </div>
            </div>
          `;
          card.addEventListener('click', () => loadUserRepos(item.login));
        } else {
          card.innerHTML = `
            <div class="flex flex-col gap-1">
              <p class="font-semibold text-github-accent">${item.full_name}</p>
              <p class="text-xs text-gray-500 line-clamp-1">${item.description || 'æ— æè¿°'}</p>
              <div class="flex items-center gap-3 text-xs text-gray-500 mt-1">
                <span>â­ ${item.stargazers_count}</span>
                <span>ğŸ´ ${item.forks_count}</span>
                ${item.language ? `<span class="flex items-center gap-1"><span class="w-2 h-2 rounded-full bg-gray-500"></span>${item.language}</span>` : ''}
              </div>
            </div>
          `;
          card.addEventListener('click', () => loadRepoFiles(item.full_name));
        }
        searchResult.appendChild(card);
      });
    }

    async function loadUserRepos(username) {
      searchResult.innerHTML = '<div class="text-center text-gray-400 py-8"><span class="loading-emoji text-3xl">ğŸ”„</span></div>';
      try {
        const res = await fetch(`https://api.github.com/users/${username}/repos?per_page=20`);
        if (!res.ok) throw new Error('åŠ è½½ä»“åº“å¤±è´¥');
        const data = await res.json();
        currentSearchType = 'repo';
        searchUser.classList.remove('bg-github-accent', 'text-white');
        searchUser.classList.add('bg-gray-200', 'text-gray-700');
        searchRepo.classList.remove('bg-gray-200', 'text-gray-700');
        searchRepo.classList.add('bg-github-accent', 'text-white');
        renderSearchResult(data);
      } catch (err) {
        searchResult.innerHTML = `<div class="text-center text-red-500 py-8"><span class="emoji-icon mr-1">âŒ</span> ${err.message}</div>`;
      }
    }

    async function loadRepoFiles(fullName) {
      currentRepo = fullName;
      projectTitle.textContent = `/${fullName} æ–‡ä»¶åˆ—è¡¨`;
      fileList.innerHTML = '<div class="text-center text-gray-400 py-8"><span class="loading-emoji text-3xl">ğŸ”„</span></div>';
      try {
        const res = await fetch(`https://api.github.com/repos/${fullName}/contents`);
        if (!res.ok) throw new Error('åŠ è½½æ–‡ä»¶å¤±è´¥');
        const data = await res.json();
        renderFileList(data);
      } catch (err) {
        fileList.innerHTML = `<div class="text-center text-red-500 py-8"><span class="emoji-icon mr-1">âŒ</span> ${err.message}</div>`;
      }
    }

    function renderFileList(files) {
      if (!files.length) {
        fileList.innerHTML = '<div class="text-center text-gray-400 py-8"><span class="emoji-icon mr-1">ğŸ“‚</span> ä»“åº“ä¸ºç©º</div>';
        return;
      }
      fileList.innerHTML = '';
      files.forEach(file => {
        const item = document.createElement('div');
        item.className = 'p-2 rounded-md hover:bg-github-secondary cursor-pointer mb-1 flex items-center gap-2';
        const icon = file.type === 'dir' 
          ? '<span class="emoji-icon">ğŸ“</span>'
          : getFileIcon(file.name);
        item.innerHTML = `
          ${icon}
          <span class="text-sm ${file.type === 'dir' ? 'font-medium' : ''}">${file.name}</span>
        `;
        if (file.type === 'dir') {
          item.addEventListener('click', () => loadSubDir(file.path));
        } else {
          item.addEventListener('click', () => loadCodeFile(file));
        }
        fileList.appendChild(item);
      });
    }

    async function loadSubDir(path) {
      fileList.innerHTML = '<div class="text-center text-gray-400 py-8"><span class="loading-emoji text-3xl">ğŸ”„</span></div>';
      try {
        const res = await fetch(`https://api.github.com/repos/${currentRepo}/contents/${path}`);
        if (!res.ok) throw new Error('åŠ è½½æ–‡ä»¶å¤¹å¤±è´¥');
        const data = await res.json();
        renderFileList(data);
      } catch (err) {
        fileList.innerHTML = `<div class="text-center text-red-500 py-8"><span class="emoji-icon mr-1">âŒ</span> ${err.message}</div>`;
      }
    }

    async function loadCodeFile(file) {
      currentFile = file;
      codeContainer.innerHTML = '<div class="text-center text-gray-400 py-8"><span class="loading-emoji text-3xl">ğŸ”„</span></div>';
      try {
        const res = await fetch(file.download_url);
        if (!res.ok) throw new Error('åŠ è½½æºç å¤±è´¥');
        currentCode = await res.text();
        codeTitle.textContent = file.name;
        const ext = file.name.split('.').pop() || 'txt';
        const lang = getPrismLang(ext);
        codeContainer.innerHTML = `
          <pre class="bg-github-dark p-4 rounded-md overflow-x-auto h-full w-full"><code class="language-${lang} mono text-sm">${Prism.highlight(currentCode, Prism.languages[lang], lang)}</code></pre>
        `;
      } catch (err) {
        codeContainer.innerHTML = `<div class="text-center text-red-500 py-8"><span class="emoji-icon mr-1">âŒ</span> ${err.message}</div>`;
      }
    }

    function getFileIcon(filename) {
      const ext = filename.split('.').pop() || '';
      const iconMap = {
        js: '<span class="emoji-icon">ğŸ“„</span>',
        html: '<span class="emoji-icon">ğŸ“„</span>',
        css: '<span class="emoji-icon">ğŸ“„</span>',
        json: '<span class="emoji-icon">ğŸ“„</span>',
        py: '<span class="emoji-icon">ğŸ“„</span>',
        java: '<span class="emoji-icon">ğŸ“„</span>',
        md: '<span class="emoji-icon">ğŸ“</span>',
        txt: '<span class="emoji-icon">ğŸ“</span>',
        gitignore: '<span class="emoji-icon">âš™ï¸</span>',
        sh: '<span class="emoji-icon">âš™ï¸</span>'
      };
      return iconMap[ext] || '<span class="emoji-icon">ğŸ“„</span>';
    }

    function getPrismLang(ext) {
      const langMap = {
        js: 'javascript',
        html: 'html',
        css: 'css',
        json: 'json',
        py: 'python',
        java: 'java',
        md: 'markdown',
        sh: 'bash'
      };
      return langMap[ext] || 'text';
    }
  </script>
</body>
</html>
